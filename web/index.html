<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bluetooth Attendance System</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css" />
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
      <a class="navbar-brand" href="#">Bluetooth Attendance</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link active" href="#dashboard" data-page="dashboard">Dashboard</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#students" data-page="students">Students</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#attendance" data-page="attendance">Attendance</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#reports" data-page="reports">Reports</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container mt-4">
    <!-- Dashboard Page -->
    <div id="dashboard-page" class="page active">
      <h2>Dashboard</h2>
      <div class="row">
        <div class="col-md-4">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">Total Students</h5>
              <p class="card-text" id="totalStudents">0</p>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">Today's Attendance</h5>
              <p class="card-text" id="todayAttendance">Present: 0, Absent: 0</p>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">Active Session</h5>
              <p class="card-text" id="activeSession">None</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Students Page -->
    <div id="students-page" class="page" style="display:none;">
      <h2>Students</h2>
      <div class="mb-3">
        <input type="text" id="studentSearch" class="form-control" placeholder="Search students...">
      </div>
      <button class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addStudentModal">Add Student</button>
      <button class="btn btn-secondary mb-3" id="uploadCsvBtn">Upload CSV</button>
      <input type="file" id="csvFile" accept=".csv">
      <div class="table-responsive">
        <table class="table table-striped" id="studentsTable">
          <thead>
            <tr>
              <th>Student ID</th>
              <th>Name</th>
              <th>MAC</th>
            </tr>
          </thead>
          <tbody id="studentsBody">
          </tbody>
        </table>
      </div>
    </div>

    <!-- Attendance Page -->
    <div id="attendance-page" class="page" style="display:none;">
      <h2>Attendance</h2>
      <div class="row mb-3">
        <div class="col-md-6">
          <input id="sessionName" type="text" class="form-control" placeholder="Session name">
        </div>
        <div class="col-md-6">
          <button id="startSessionBtn" class="btn btn-success">Start Session</button>
          <button id="endSessionBtn" class="btn btn-danger">End Session</button>
        </div>
      </div>
      <div class="mb-3">
        <span id="activeSessionBadge" class="badge bg-secondary">No active session</span>
      </div>
      <div class="row mb-3">
        <div class="col-md-6">
          <button id="startScanBtn" class="btn btn-primary">Start Bluetooth Scan</button>
          <button id="manualMarkBtn" class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#manualMarkModal">Manual Mark</button>
        </div>
        <div class="col-md-6">
          <select id="scopeSelect" class="form-select">
            <option value="session">Current session</option>
            <option value="today">Today</option>
            <option value="all">All</option>
          </select>
        </div>
      </div>
      <div class="mb-3">
        <span id="status" class="text-muted"></span>
      </div>
      <div class="table-responsive">
        <table class="table table-striped" id="attendanceTable">
          <thead>
            <tr>
              <th>Timestamp</th>
              <th>Student ID</th>
              <th>Name</th>
              <th>MAC</th>
              <th>Session</th>
            </tr>
          </thead>
          <tbody id="attendanceBody">
          </tbody>
        </table>
      </div>
    </div>

    <!-- Reports Page -->
    <div id="reports-page" class="page" style="display:none;">
      <h2>Reports</h2>
      <div class="row mb-3">
        <div class="col-md-6">
          <select id="sessionSelect" class="form-select">
            <option value="">Select Session</option>
          </select>
        </div>
        <div class="col-md-6">
          <button id="exportPdfBtn" class="btn btn-primary">Export PDF</button>
          <button id="exportExcelBtn" class="btn btn-success">Export Excel</button>
        </div>
      </div>
      <div class="row">
        <div class="col-md-6">
          <h4>Summary</h4>
          <p id="summaryText">Select a session to view summary.</p>
        </div>
        <div class="col-md-6">
          <canvas id="attendanceChart"></canvas>
        </div>
      </div>
    </div>
  </div>

  <!-- Modals -->
  <!-- Add Student Modal -->
  <div class="modal fade" id="addStudentModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Add Student</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="addStudentForm">
            <div class="mb-3">
              <label for="studentId" class="form-label">Student ID</label>
              <input type="text" class="form-control" id="studentId" required>
            </div>
            <div class="mb-3">
              <label for="studentName" class="form-label">Name</label>
              <input type="text" class="form-control" id="studentName" required>
            </div>
            <div class="mb-3">
              <label for="studentMac" class="form-label">MAC Address (optional)</label>
              <input type="text" class="form-control" id="studentMac">
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" id="saveStudentBtn">Save</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Manual Mark Modal -->
  <div class="modal fade" id="manualMarkModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Manual Attendance</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="manualMarkForm">
            <div class="mb-3">
              <label for="manualStudentId" class="form-label">Student ID or Name</label>
              <input type="text" class="form-control" id="manualStudentId" required>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" id="markAttendanceBtn">Mark Attendance</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
